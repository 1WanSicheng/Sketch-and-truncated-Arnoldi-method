The code are basically algortihm 1 in different ways of getting \widehat{H_d} 
One is using direct compution, which is much slower since it needs to update each entry in each iteration
One is using updating method, which is much faster 
